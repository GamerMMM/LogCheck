# FilterEngine æœç´¢æ—¶é—´æµ‹é‡åŠŸèƒ½

## æ¦‚è¿°

ä¸º `FilterEngine` ç±»æ·»åŠ äº†å®Œæ•´çš„æ—¶é—´æµ‹é‡åŠŸèƒ½ï¼Œå¯ä»¥ç²¾ç¡®æµ‹é‡æœç´¢æ€§èƒ½ï¼Œå¸®åŠ©ä¼˜åŒ–æœç´¢ç®—æ³•å’Œè¯†åˆ«æ€§èƒ½ç“¶é¢ˆã€‚

## æ–°å¢åŠŸèƒ½

### 1. è‡ªåŠ¨æ—¶é—´æµ‹é‡

æ¯æ¬¡æœç´¢éƒ½ä¼šè‡ªåŠ¨è®°å½•ä»¥ä¸‹æ—¶é—´ä¿¡æ¯ï¼š

- **æœç´¢å¤„ç†æ—¶é—´**: çº¯æœç´¢ç®—æ³•æ‰§è¡Œæ—¶é—´
- **ç¼–è¾‘å™¨åº”ç”¨æ—¶é—´**: å°†ç»“æœåº”ç”¨åˆ°ç¼–è¾‘å™¨çš„æ—¶é—´
- **æ€»è€—æ—¶**: ä»å¼€å§‹åˆ°ç»“æŸçš„å®Œæ•´æ—¶é—´

### 2. æ€§èƒ½æµ‹è¯•æ–¹æ³•

æ–°å¢ `measure_search_performance()` æ–¹æ³•ï¼Œå¯ä»¥ï¼š
- å¤šæ¬¡è¿è¡Œæœç´¢å–å¹³å‡å€¼
- è®¡ç®—æœ€çŸ­/æœ€é•¿/å¹³å‡è€—æ—¶
- æ˜¾ç¤ºå¤„ç†é€Ÿåº¦ï¼ˆè¡Œ/ç§’ï¼‰
- æä¾›è¯¦ç»†çš„æ€§èƒ½ç»Ÿè®¡

### 3. æ—¶é—´æŸ¥è¯¢æ–¹æ³•

- `get_last_search_time()`: è·å–æœ€åä¸€æ¬¡æœç´¢çš„æ€»è€—æ—¶
- æœç´¢ç»“æœä¸­åŒ…å« `search_time` å­—æ®µ

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨

```python
from logic.filter_engine import FilterEngine, SearchOptions

# åˆ›å»ºè¿‡æ»¤å™¨å¼•æ“
engine = FilterEngine(max_workers=4)

# è®¾ç½®æœç´¢é€‰é¡¹
options = SearchOptions(
    show_only=False,
    ignore_alpha=True,
    whole_pair=False
)

# æ‰§è¡Œæœç´¢
result = engine.parallel_search_text(
    text_content, 
    include_keywords=["ERROR", "WARNING"],
    exclude_keywords=["DEBUG"],
    options=options
)

# æŸ¥çœ‹æœç´¢æ—¶é—´
print(f"æœç´¢è€—æ—¶: {result.search_time:.3f}ç§’")
print(f"åŒ¹é…è¡Œæ•°: {len(result.matched_lines)}")
```

### æ€§èƒ½æµ‹è¯•

```python
# è¿è¡Œæ€§èƒ½æµ‹è¯•ï¼ˆå¤šæ¬¡æœç´¢å–å¹³å‡å€¼ï¼‰
performance_stats = engine.measure_search_performance(
    text_content=large_text,
    include_keywords=["ERROR", "WARNING"],
    exclude_keywords=["DEBUG"],
    options=options,
    iterations=5  # è¿è¡Œ5æ¬¡å–å¹³å‡å€¼
)

print(f"å¹³å‡è€—æ—¶: {performance_stats['average_time']:.3f}ç§’")
print(f"å¤„ç†é€Ÿåº¦: {performance_stats['total_lines'] / performance_stats['average_time']:.0f} è¡Œ/ç§’")
```

## æµ‹è¯•è„šæœ¬

### è¿è¡Œæ€§èƒ½æµ‹è¯•

```bash
python test_search_performance.py
```

### è¿è¡Œä½¿ç”¨ç¤ºä¾‹

```bash
python usage_example.py
```

## è¾“å‡ºç¤ºä¾‹

### æœç´¢å®Œæˆè¾“å‡º

```
ğŸ” æœç´¢å®Œæˆ - æ€»è€—æ—¶: 0.156ç§’
   - æœç´¢å¤„ç†æ—¶é—´: 0.123ç§’
   - ç¼–è¾‘å™¨åº”ç”¨æ—¶é—´: 0.033ç§’
   - åŒ¹é…è¡Œæ•°: 67
   - æ€»è¡Œæ•°: 5000
```

### æ€§èƒ½æµ‹è¯•è¾“å‡º

```
ğŸš€ å¼€å§‹æ€§èƒ½æµ‹è¯• - è¿è¡Œ 3 æ¬¡æœç´¢...
   ç¬¬ 1 æ¬¡æµ‹è¯•...
   ç¬¬ 1 æ¬¡è€—æ—¶: 0.145ç§’, åŒ¹é…è¡Œæ•°: 67
   ç¬¬ 2 æ¬¡æµ‹è¯•...
   ç¬¬ 2 æ¬¡è€—æ—¶: 0.138ç§’, åŒ¹é…è¡Œæ•°: 67
   ç¬¬ 3 æ¬¡æµ‹è¯•...
   ç¬¬ 3 æ¬¡è€—æ—¶: 0.142ç§’, åŒ¹é…è¡Œæ•°: 67
ğŸ“Š æ€§èƒ½æµ‹è¯•ç»“æœ:
   - å¹³å‡è€—æ—¶: 0.142ç§’
   - æœ€çŸ­è€—æ—¶: 0.138ç§’
   - æœ€é•¿è€—æ—¶: 0.145ç§’
   - æ€»è¡Œæ•°: 5000
   - åŒ¹é…è¡Œæ•°: 67
``` 